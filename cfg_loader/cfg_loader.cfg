// -----------------------------------------------------------------------------
// Configuration Loader
// -----------------------------------------------------------------------------
//
// Description:
//
// This script helps loading configuration files.
// Unlike the normal way of loading via 'exec', this script detects, if a script
// couldn't be loaded. It will stop loading remaining files and can also output
// an error message instead
//
//
// Usage:
//
// For this to work, you need to add the following line at the end of every
// .cfg file that you want to load:
//
//     cfg_end
//
// To load a file, instead of using 'exec config.cfg', you can use:
//
//     alias cfg_file "exec config.cfg"; cfg_load
//
// -----------------------------------------------------------------------------

// --------------------------------- Interface ---------------------------------

// indicate the end of an config file
alias cfg_end "cfgo_cfg_load_s_set_1"

// ---------------------------------- Options ----------------------------------

// Messages for successful (1) and unsuccessful (0) loading
alias cfgo_cfg_load_s_0_m "cfgo_out_hl;echo ERROR while loading! - SKIPPING all following configs.;cfgo_out_hl"
alias cfgo_cfg_load_s_1_m "echo loaded!"
alias cfgo_cfg_load_s_2_m "echo SKIPPED loading!"

// -----------------------------------------------------------------------------


// Status and setters
alias cfgo_cfg_load_s_is
alias cfgo_cfg_load_s_is_0  "alias cfg_load "cfgo_cfg_load_s_2_m";cfgo_cfg_load_s_0_m"
alias cfgo_cfg_load_s_is_1  "cfgo_cfg_load_s_1_m "

// Setter
alias cfgo_cfg_load_s_set_0 "alias cfgo_cfg_load_s_is "cfgo_cfg_load_s_is_0""
alias cfgo_cfg_load_s_set_1 "alias cfgo_cfg_load_s_is "cfgo_cfg_load_s_is_1""

// 1. load cfg
// 2. check if loading succeeded
// 3. set success to false for next config
alias cfg_load "cfgo_cfg_load_s_set_0; cfg_file; cfgo_cfg_load_s_is;cfgo_cfg_load_s_set_0"

echo config loader loaded!